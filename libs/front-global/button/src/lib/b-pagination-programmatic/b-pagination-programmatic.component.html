<ng-template
  #pagefiller
  let-items="items"
  let-pagination="pagination"
  let-showBackButton="showBackButton"
>
  <ng-container *ngFor="let item of items">
    <ng-container *ngIf="item.templateContentName">
      <ng-container
        *ngIf="findTemplate(item.templateContentName); let template"
      >
        <div (click)="clickAction(item, pagination)">
          <div *ngTemplateOutlet="template"></div>
        </div>
      </ng-container>
    </ng-container>
    <ng-container *ngIf="item.customTemplate">
      <div (click)="clickAction(item, pagination)">
        <div *ngTemplateOutlet="item.customTemplate"></div>
      </div>
    </ng-container>
    <ng-container
      *ngIf="
        !item.templateContentName &&
        !item.toggleValues &&
        !item.customTemplate &&
        (item.show == null || (item.show | async))
      "
    >
      <block-button
        [cover]="true"
        [iconClass]="
          item.childPaginationItems ||
          (!item.iconClass &&
            !item.customTemplate &&
            !item.iconContent &&
            !item.iconImageSource)
            ? 'pi pi-chevron-right'
            : item.iconClass
        "
        [iconContent]="item.iconContent"
        [iconImageSource]="item.iconImageSource"
        [buttonClass]="item.buttonClass || 'surface'"
        iconPosition="RIGHT"
        (click)="clickAction(item, pagination)"
      >
        <div [ngClass]="item.fontClass || []" [style]="item.fontStyle || []">
          {{ item.text | translate }}
        </div>
      </block-button>
    </ng-container>
  </ng-container>
  <block-button
    iconClass="pi pi-chevron-left"
    *ngIf="showBackButton"
    [cover]="true"
    buttonClass="surface"
    (click)="pagination.back()"
    iconPosition="LEFT"
  >
    <b>{{ 'mona.back' | translate }}</b>
  </block-button>
</ng-template>

<ubs-touch-pagination
  [width]="width()"
  [height]="height()"
  (pageChange)="isInFirst.emit($event == 'main')"
  #pagination
>
  <ng-template block-page="main">
    <div
      *ngTemplateOutlet="
        pagefiller;
        context: { items: paginationItems() | clean, pagination: pagination }
      "
    ></div>
  </ng-template>

  <ng-template
    *ngFor="let otherPage of childPaginationItems()"
    [block-page]="otherPage.pageKey || ''"
  >
    <div
      *ngTemplateOutlet="
        pagefiller;
        context: {
          items: otherPage.pagiationItems | clean,
          pagination: pagination,
          showBackButton: true
        }
      "
    ></div>
  </ng-template>
</ubs-touch-pagination>
